# AI Agent Rules & Context: hy-home.docker

## Project Overview

This repository (`hy-home.docker`) is a **Home Lab Infrastructure Monorepo** managing a complete local environment using **Docker Compose**. It focuses on High Availability (HA), Observability, and a modern "Context-First" AI workflow.

## Tech Stack & Key Components

- **Container Engine**: Docker Engine & Docker Compose (Plugin).
- **Core Database**: PostgreSQL (HA via Patroni & Etcd/Consul), MongoDB, Redis/Valkey.
- **Observability (LGTM)**: Loki (Logs), Grafana (Visuals), Tempo (Traces), Mimir (Metrics), Alloy (Collector).
- **Identity**: Keycloak (SSO/IAM).
- **Streaming**: Kafka, Redpanda.
- **AI/ML**: Ollama, Qdrant.

## Critical Rules for Agents

1. **Command Syntax**: ALWAYS use `docker compose` (v2), NEVER `docker-compose` (v1).
2. **Path Awareness**:
   - `infra/` contains the Docker Compose services.
   - `scripts/` contains automation. ALWAYS check for a script before proposing manual commands.
     - Example: Use `./scripts/new_infra_service.sh` to add services.
     - Example: Use `./scripts/validate_compose_change.sh` to check syntax.
   - `docs/` is the Source of Truth for architecture and guides.
3. **Secrets**: NEVER hardcode secrets. Use the `secrets/` directory reference pattern in compose files (e.g., `file: ../secrets/my_secret.txt`).
4. **Agent Behavior**:
   - READ `.agent/rules/` for detailed behavioral governing.
   - CHECK `.agent/workflows/` for standard operating procedures.

## Documentation Priorities

- Update `docs/` when changing infrastructure.
- Maintain `README.md` as a high-level entry point.
