name: terraform
services:
  terraform:
    image: hashicorp/terraform:1.14.4
    container_name: terraform
    volumes:
      - ./workspace:/workspace
      # - $HOME/.config/gcloud:/root/.config/gcloud # Optional: For GCP Auth
      - $HOME/.aws:/root/.aws # Optional: For AWS Auth
      - $HOME/.azure:/root/.azure # Optional: For Azure Auth
    working_dir: /workspace
    entrypoint: ["terraform"]
    networks:
      - infra_net

networks:
  infra_net:
    name: infra_net
    driver: bridge
    ipam:
      config:
        - subnet: ${INFRA_SUBNET:-172.19.0.0/16}
          gateway: ${INFRA_GATEWAY:-172.19.0.1}
