## config/oauth2-proxy.cfg (Example)
# 실제 사용 시에는 이 파일을 복사하여 oauth2-proxy.cfg로 저장하고 환경에 맞게 수정하세요.

# --- Provider 설정 ---
provider = "keycloak-oidc"
scope = "openid email profile offline_access groups"

# Keycloak OIDC 발급자 URL
oidc_issuer_url = "https://keycloak.${DEFAULT_URL}/realms/${KEYCLOAK_REALM}"

# PKCE 설정
code_challenge_method = "S256"

# --- URL 및 응답 설정 ---
redirect_url = "https://auth.${DEFAULT_URL}/oauth2/callback"

# [핵심] 404 방지용 Upstream
upstreams = [ "static://200" ]

# --- 쿠키 설정 ---
cookie_name = "__Secure-sso-cookie"
cookie_domains = [ ".${DEFAULT_URL}" ]
cookie_secure = true
cookie_httponly = true
cookie_samesite = "lax"
cookie_path = "/"
cookie_refresh = "1h"
cookie_expire = "12h"

# --- 도메인 화이트리스트 ---
whitelist_domains = [ "*.${DEFAULT_URL}" ]
email_domains = [ "*" ]

# --- 서버 설정 ---
http_address = "0.0.0.0:4180"
reverse_proxy = true
skip_provider_button = true

# 헤더를 통한 클레임 전달 설정
pass_authorization_header = true
pass_access_token = true
set_authorization_header = true
set_xauthrequest = true

# --- SSL 설정 ---
ssl_insecure_skip_verify = false
