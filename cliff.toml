# git-cliff configuration file
# https://git-cliff.org/docs/configuration

[changelog]
  # changelog header
  header="""
# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.1.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).
"""
  # template for the changelog body
  # https://keats.github.io/tera/docs/#introduction
  body="""
{% if version %}\
    ## [{{ version | trim_start_matches(pat="v") }}] - {{ timestamp | date(format="%Y-%m-%d") }}
{% else %}\
    ## [Unreleased]
{% endif %}\
{% for group, commits in commits | group_by(attribute="group") %}
    ### {{ group | upper_first }}
    {% for commit in commits %}
        - {% if commit.scope %}**{{ commit.scope }}:** {% endif %}\
            {{ commit.message | upper_first }}\
    {% endfor %}
{% endfor %}\n
"""
  # template for the changelog footer
  footer="""
{% for release in releases -%}
    {% if release.version -%}
        {% if release.previous and release.previous.version -%}
            [{{ release.version | trim_start_matches(pat="v") }}]: https://github.com/buenhyden/hy-home.docker/compare/{{ release.previous.version }}...{{ release.version }}
        {% endif -%}
    {% else -%}
        {% if release.previous and release.previous.version -%}
            [unreleased]: https://github.com/buenhyden/hy-home.docker/compare/{{ release.previous.version }}...HEAD
        {% endif -%}
    {% endif -%}
{% endfor %}
"""
  # remove the leading and trailing whitespace from the templates
  trim=true

[git]
  # parse the commits based on https://www.conventionalcommits.org
  conventional_commits=true
  # filter out the commits that are not conventional
  filter_unconventional=true
  # process each line of a commit as an individual commit
  split_commits=false
  # regex for preprocessing the commit messages
  commit_preprocessors=[
    # replace issue numbers with links
    {pattern='#([0-9]+)', replace="([#${1}](https://github.com/buenhyden/hy-home.docker/issues/${1}))"},
  ]
  # regex for parsing and grouping commits
  commit_parsers=[
    {body=".*BREAKING CHANGE", group="Breaking Changes"},
    {message="^chore", group="Miscellaneous"},
    {message="^chore\\(release\\)", skip=true},
    {message="^doc", group="Documentation"},
    {message="^feat", group="Added"},
    {message="^fix", group="Fixed"},
    {message="^perf", group="Performance"},
    {message="^refactor", group="Changed"},
    {message="^revert", group="Removed"},
    {message="^style", group="Styles"},
    {message="^test", group="Testing"},
  ]
  # protect breaking changes from being skipped due to matching a skipping commit_parser
  protect_breaking_commits = false
  # protect github users from unauthorized exposure
  filter_commits = false
  # regex for matching git tags
  tag_pattern="v[0-9]*"
  # regex for skipping tags
  skip_tags="v0.1.0-beta.1"
  # regex for ignoring tags
  ignore_tags=""
  # sort the tags topologically
  topo_order=false
  # sort the commits inside sections by oldest/newest order
  sort_commits="oldest"
  # limit the number of commits included in the changelog.
  # limit_commits = 42
