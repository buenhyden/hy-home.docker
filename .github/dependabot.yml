# ============================================================================
# Dependabot Configuration for Hy-Home Infrastructure
# 의존성을 자동으로 최신 상태로 유지하며, 인프라 최적화 환경에 맞춰 관리합니다.
# ============================================================================

version: 2
updates:
  # 1. GitHub Actions
  # 워크플로우 내의 Action 버전들을 주간 단위로 확인합니다.
  - package-ecosystem: 'github-actions'
    directory: '/'
    schedule:
      interval: 'weekly'
      day: 'monday'
    open-pull-requests-limit: 10
    cooldown:
      default-days: 7
    labels:
      - 'dependencies'
      - 'github-actions'
    groups:
      actions:
        patterns:
          - '*'

  # 2. Docker (Root)
  # 루트 디렉토리의 Dockerfile 및 Docker Compose 파일의 베이스 이미지를 감시합니다.
  - package-ecosystem: 'docker'
    directory: '/'
    schedule:
      interval: 'weekly'
      day: 'monday'
    open-pull-requests-limit: 10
    labels:
      - 'dependencies'
      - 'docker'
    groups:
      actions:
        patterns:
          - '*'
    cooldown:
      default-days: 7

  # 3. Docker (Infra Layer)
  # infra/ 디렉토리 하위의 인프라 서비스 관련 Docker 의존성을 감시합니다.
  - package-ecosystem: 'docker'
    directory: '/infra/01-gateway/traefik'
    schedule: { interval: 'weekly', day: 'monday' }
    open-pull-requests-limit: 10
    cooldown: { default-days: 7 }
    groups:
      infra-dependencies: { patterns: ['*'] }

  - package-ecosystem: 'docker'
    directory: '/infra/02-auth/keycloak'
    schedule: { interval: 'weekly', day: 'monday' }
    open-pull-requests-limit: 10
    cooldown: { default-days: 7 }
    groups:
      infra-dependencies: { patterns: ['*'] }

  - package-ecosystem: 'docker'
    directory: '/infra/02-auth/oauth2-proxy'
    schedule: { interval: 'weekly', day: 'monday' }
    open-pull-requests-limit: 10
    cooldown: { default-days: 7 }
    groups:
      infra-dependencies: { patterns: ['*'] }

  - package-ecosystem: 'docker'
    directory: '/infra/04-data/mng-db'
    schedule: { interval: 'weekly', day: 'monday' }
    open-pull-requests-limit: 10
    cooldown: { default-days: 7 }
    groups:
      infra-dependencies: { patterns: ['*'] }

  - package-ecosystem: 'docker'
    directory: '/infra/04-data/minio'
    schedule: { interval: 'weekly', day: 'monday' }
    open-pull-requests-limit: 10
    cooldown: { default-days: 7 }
    groups:
      infra-dependencies: { patterns: ['*'] }

  - package-ecosystem: 'docker'
    directory: '/infra/04-data/qdrant'
    schedule: { interval: 'weekly', day: 'monday' }
    open-pull-requests-limit: 10
    cooldown: { default-days: 7 }
    groups:
      infra-dependencies: { patterns: ['*'] }

  - package-ecosystem: 'docker'
    directory: '/infra/04-data/postgresql-cluster'
    schedule: { interval: 'weekly', day: 'monday' }
    open-pull-requests-limit: 10
    cooldown: { default-days: 7 }
    groups:
      infra-dependencies: { patterns: ['*'] }

  - package-ecosystem: 'docker'
    directory: '/infra/04-data/valkey-cluster'
    schedule: { interval: 'weekly', day: 'monday' }
    open-pull-requests-limit: 10
    cooldown: { default-days: 7 }
    groups:
      infra-dependencies: { patterns: ['*'] }

  - package-ecosystem: 'docker'
    directory: '/infra/04-data/opensearch'
    schedule: { interval: 'weekly', day: 'monday' }
    open-pull-requests-limit: 10
    cooldown: { default-days: 7 }
    groups:
      infra-dependencies: { patterns: ['*'] }

  - package-ecosystem: 'docker'
    directory: '/infra/05-messaging/kafka'
    schedule: { interval: 'weekly', day: 'monday' }
    open-pull-requests-limit: 10
    cooldown: { default-days: 7 }
    groups:
      infra-dependencies: { patterns: ['*'] }

  - package-ecosystem: 'docker'
    directory: '/infra/06-observability'
    schedule: { interval: 'weekly', day: 'monday' }
    open-pull-requests-limit: 10
    cooldown: { default-days: 7 }
    groups:
      infra-dependencies: { patterns: ['*'] }

  - package-ecosystem: 'docker'
    directory: '/infra/07-workflow/n8n'
    schedule: { interval: 'weekly', day: 'monday' }
    open-pull-requests-limit: 10
    cooldown: { default-days: 7 }
    groups:
      infra-dependencies: { patterns: ['*'] }

  - package-ecosystem: 'docker'
    directory: '/infra/07-workflow/airflow'
    schedule: { interval: 'weekly', day: 'monday' }
    open-pull-requests-limit: 10
    cooldown: { default-days: 7 }
    groups:
      infra-dependencies: { patterns: ['*'] }

  - package-ecosystem: 'docker'
    directory: '/infra/08-ai/ollama'
    schedule: { interval: 'weekly', day: 'monday' }
    open-pull-requests-limit: 10
    cooldown: { default-days: 7 }
    groups:
      infra-dependencies: { patterns: ['*'] }

  - package-ecosystem: 'docker'
    directory: '/infra/08-ai/open-webui'
    schedule: { interval: 'weekly', day: 'monday' }
    open-pull-requests-limit: 10
    cooldown: { default-days: 7 }
    groups:
      infra-dependencies: { patterns: ['*'] }

  - package-ecosystem: 'docker'
    directory: '/infra/09-tooling/sonarqube'
    schedule: { interval: 'weekly', day: 'monday' }
    open-pull-requests-limit: 10
    cooldown: { default-days: 7 }
    groups:
      infra-dependencies: { patterns: ['*'] }

  - package-ecosystem: 'docker'
    directory: '/infra/09-tooling/terrakube'
    schedule: { interval: 'weekly', day: 'monday' }
    open-pull-requests-limit: 10
    cooldown: { default-days: 7 }
    groups:
      infra-dependencies: { patterns: ['*'] }

  - package-ecosystem: 'docker'
    directory: '/infra/10-communication/mail'
    schedule: { interval: 'weekly', day: 'monday' }
    open-pull-requests-limit: 10
    cooldown: { default-days: 7 }
    groups:
      infra-dependencies: { patterns: ['*'] }

  # 4. Terraform (If applicable)
  # infra/ 디렉토리 내에 Terraform 파일이 존재할 경우 활성화됩니다.
  - package-ecosystem: 'terraform'
    directory: '/infra'
    schedule:
      interval: 'weekly'
    open-pull-requests-limit: 10
    cooldown:
      default-days: 7
